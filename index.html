<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Konverter Pulsa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f8fa;
        }
        .container {
            max-width: 400px;
            margin: auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        .card {
            background-color: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            text-align: center;
            width: 100%;
        }
        .logo-text {
            color: #ff6e40;
            font-size: 2.25rem;
            font-weight: 700;
            letter-spacing: -0.05em;
        }
        .welcome-text {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1a202c;
            margin-top: 1.5rem;
        }
        .promo-text {
            font-size: 0.875rem;
            color: #4a5568;
            margin-top: 0.5rem;
        }
        .btn-google {
            background-color: #fff;
            color: #1a202c;
            border: 1px solid #e2e8f0;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            font-weight: 500;
            width: 100%;
            margin-top: 2rem;
            transition: all 0.2s;
        }
        .btn-google:hover {
            background-color: #f7fafc;
        }
        .google-icon {
            width: 1.5rem;
            height: 1.5rem;
        }
        .footer-links {
            font-size: 0.875rem;
            color: #4a5568;
            margin-top: 1rem;
        }
        .footer-links a {
            color: #ff6e40;
            font-weight: 600;
            text-decoration: none;
        }
        .footer-links a:hover {
            text-decoration: underline;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #ff6e40;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .message-box {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        .message-box.success {
            background-color: #d1f7e0;
            color: #2f855a;
        }
        .error-message {
            color: #e53e3e;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }
    </style>
</head>
<body>
    <!-- Overlay untuk loading -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <div class="container">
        <div class="card">
            <!-- Menampilkan gambar yang diunggah -->
            <img src="https://placehold.co/300x200/FFFFFF/000000?text=Gambar+Animasi" alt="Gambar ilustrasi" class="mx-auto my-4 w-auto h-48">

            <h2 class="welcome-text">Ayo Login, Ada Promo Menunggu!</h2>
            <p class="promo-text">Nikmati kemudahan transaksi dan promo eksklusif khusus pengguna yang login.</p>
            
            <button id="google-login-btn" class="btn-google">
                <svg class="google-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12.24 10.213c-1.372 0-2.617-.468-3.64-1.258V6.634C9.563 5.378 10.74 4.542 12.24 4.542c1.5 0 2.677.836 3.64 2.052l2.396-1.921C16.96 3.03 14.77 1.542 12.24 1.542c-2.48 0-4.67 1.488-6.196 3.738L4.364 3.03C2.84 5.28 1.956 7.64 1.956 10.213s.884 4.933 2.408 7.183l1.68-1.558C5.232 15.352 4.4 13.585 4.4 11.666c0-1.919.832-3.686 2.408-4.94L7.85 5.567C8.756 4.61 10.04 4.092 11.458 4.092c1.417 0 2.702.518 3.64 1.536l-1.314 1.22c-.938-1.018-2.072-1.536-3.418-1.536-1.5 0-2.677.836-3.64 2.052l-2.396 1.921C7.03 12.394 9.22 13.88 11.7 13.88c2.48 0 4.67-1.488 6.196-3.738l1.68 1.558C17.228 15.352 16.4 17.119 16.4 19.038c0 1.919-.832 3.686-2.408 4.94L12.592 22.42c-1.666-1.638-2.5-3.69-2.5-5.918 0-2.228.834-4.28 2.5-5.918z" fill="#000000"/>
                </svg>
                Masuk dengan Google
            </button>

            <div id="status-message" class="message-box"></div>
            <div id="error-message" class="error-message"></div>

            <p class="footer-links">
                Sudah punya Akun? <a href="#">Masuk di sini</a>
            </p>
        </div>
        <p class="mt-4 text-xs text-gray-400">Powered by Viapulsa</p>
    </div>

    <script type="module">
        // Import fungsi yang Anda butuhkan dari Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";

        // Konfigurasi aplikasi web Firebase Anda
        const firebaseConfig = {
            apiKey: "AIzaSyDWYM3D8HIz5vPy8ljsSnKL-zHz6zaqBBA",
            authDomain: "webseit-convert-pulsa.firebaseapp.com",
            projectId: "webseit-convert-pulsa",
            storageBucket: "webseit-convert-pulsa.firebasestorage.app",
            messagingSenderId: "306830134070",
            appId: "1:306830134070:web:23c764342a141749238197",
            measurementId: "G-CXFQMYJXNY"
        };
        
        // --- DOM Elements ---
        const googleLoginBtn = document.getElementById('google-login-btn');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const statusMessage = document.getElementById('status-message');
        const errorMessage = document.getElementById('error-message');

        // --- Helper Functions ---
        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }

        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }

        function showMessage(element, message, type) {
            if (!element) {
                console.error("Elemen pesan tidak ditemukan di DOM.");
                return;
            }
            element.textContent = message;
            element.style.display = 'block';
            if (type === 'success') {
                element.classList.add('success');
                element.classList.remove('error');
            } else {
                element.classList.add('error');
                element.classList.remove('success');
            }
        }
        
        // --- Inisialisasi Firebase ---
        let auth;
        try {
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            getAnalytics(app); // Menginisialisasi analytics
        } catch (e) {
            console.error("Kesalahan inisialisasi Firebase. Pastikan konfigurasi Anda benar.", e);
            showMessage(errorMessage, "Kesalahan: Gagal menginisialisasi Firebase. Periksa konsol untuk detail.", 'error');
        }

        const provider = new GoogleAuthProvider();

        // --- Event Listener ---
        if (googleLoginBtn && auth) {
            googleLoginBtn.addEventListener('click', () => {
                showLoading();
                signInWithPopup(auth, provider)
                    .then((result) => {
                        // Login berhasil
                        const user = result.user;
                        hideLoading();
                        showMessage(statusMessage, `Login Berhasil! Selamat datang, ${user.displayName}!`, 'success');
                        console.log("Login berhasil! Data pengguna:", user);
                    })
                    .catch((error) => {
                        // Login gagal
                        hideLoading();
                        const errorCode = error.code;
                        const message = error.message; 
                        showMessage(errorMessage, `Login gagal: ${message}`, 'error');
                        console.error("Login gagal:", errorCode, message);
                    });
            });
        }
    </script>
</body>
</html>
